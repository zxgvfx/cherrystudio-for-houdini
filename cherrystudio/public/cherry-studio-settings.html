<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®¾ç½® - Cherry Studio for Houdini</title>
    
    <!-- Cherry Studio æ ·å¼ -->
    <style>
        :root {
            --color-white: #ffffff;
            --color-white-soft: rgba(255, 255, 255, 0.8);
            --color-white-mute: rgba(255, 255, 255, 0.94);

            --color-black: #181818;
            --color-black-soft: #222222;
            --color-black-mute: #333333;

            --color-gray-1: #515c67;
            --color-gray-2: #414853;
            --color-gray-3: #32363f;

            --color-text-1: rgba(255, 255, 245, 0.9);
            --color-text-2: rgba(235, 235, 245, 0.6);
            --color-text-3: rgba(235, 235, 245, 0.38);

            --color-background: var(--color-black);
            --color-background-soft: var(--color-black-soft);
            --color-background-mute: var(--color-black-mute);
            --color-background-opacity: rgba(34, 34, 34, 0.7);

            --color-primary: #00b96b;
            --color-primary-soft: #00b96b99;
            --color-primary-mute: #00b96b33;

            --color-text: var(--color-text-1);
            --color-text-secondary: rgba(235, 235, 245, 0.7);
            --color-icon: #ffffff99;
            --color-icon-white: #ffffff;
            --color-border: #ffffff19;
            --color-border-soft: #ffffff10;
            --color-border-mute: #ffffff05;
            --color-error: #ff4d50;
            --color-link: #338cff;
            --color-code-background: #323232;
            --color-inline-code-background: #323232;
            --color-inline-code-text: rgb(218, 97, 92);
            --color-hover: rgba(40, 40, 40, 1);
            --color-active: rgba(55, 55, 55, 1);
            --color-frame-border: #333;
            --color-group-background: var(--color-background-soft);

            --color-reference: #404040;
            --color-reference-text: #ffffff;
            --color-reference-background: #0b0e12;

            --color-list-item: rgba(255, 255, 255, 0.1);
            --color-list-item-hover: rgba(255, 255, 255, 0.05);

            --modal-background: #111111;

            --color-highlight: rgba(0, 0, 0, 1);
            --color-background-highlight: rgba(255, 255, 0, 0.9);
            --color-background-highlight-accent: rgba(255, 150, 50, 0.9);

            --navbar-background-mac: rgba(20, 20, 20, 0.55);
            --navbar-background: #1f1f1f;

            --chat-background: transparent;
            --chat-background-user: rgba(255, 255, 255, 0.08);
            --chat-background-assistant: transparent;
            --chat-text-user: var(--color-black);

            --list-item-border-radius: 10px;

            --color-status-success: green;
            --color-status-error: var(--color-error);
            --color-status-warning: #faad14;

            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        *:focus {
            outline: none;
        }

        html, body, #app {
            height: 100%;
            width: 100%;
            margin: 0;
        }

        body {
            display: flex;
            min-height: 100vh;
            color: var(--color-text);
            font-size: 14px;
            line-height: 1.6;
            overflow: hidden;
            font-family: var(--font-family);
            text-rendering: optimizeLegibility;
            transition: background-color 0.3s linear;
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        input, textarea, [contenteditable='true'], .markdown, #messages, .selectable, pre, code {
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }

        /* ä¸»å®¹å™¨ */
        .app-container {
            display: flex;
            flex: 1;
            flex-direction: column;
            max-width: 100vw;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .top-navbar {
            height: 48px;
            background-color: var(--navbar-background);
            border-bottom: 0.5px solid var(--color-border);
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .navbar-center {
            flex: 1;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text);
        }

        .navbar-back {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 6px;
            background-color: transparent;
            border: none;
            color: var(--color-icon);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .navbar-back:hover {
            background-color: var(--color-hover);
        }

        /* è®¾ç½®å†…å®¹åŒºåŸŸ */
        .settings-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* è®¾ç½®ä¾§è¾¹æ  */
        .settings-sidebar {
            width: 240px;
            background-color: var(--color-background-soft);
            border-right: 0.5px solid var(--color-border);
            overflow-y: auto;
            padding: 16px 0;
        }

        .settings-menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: var(--color-text);
            text-decoration: none;
            transition: background-color 0.2s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .settings-menu-item:hover {
            background-color: var(--color-list-item-hover);
        }

        .settings-menu-item.active {
            background-color: var(--color-primary-mute);
            color: var(--color-primary);
        }

        .settings-menu-item-icon {
            width: 18px;
            height: 18px;
            opacity: 0.8;
        }

        .settings-menu-divider {
            height: 1px;
            background-color: var(--color-border);
            margin: 8px 0;
        }

        /* è®¾ç½®å†…å®¹åŒºåŸŸ */
        .settings-content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .settings-section {
            max-width: 800px;
        }

        /* Provider ç®¡ç†å¸ƒå±€ï¼ˆä»¿ Cherry Studioï¼‰ */
        .provider-layout {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 16px;
        }
        .provider-list-panel {
            background: var(--color-background-soft);
            border: 0.5px solid var(--color-border);
            border-radius: 8px;
            padding: 12px;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 160px);
            overflow: hidden;
        }
        .provider-search {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            border: 0.5px solid var(--color-border);
            border-radius: 8px;
            background: var(--color-background);
            color: var(--color-text);
            margin-bottom: 10px;
        }
        .provider-search input {
            border: none;
            outline: none;
            background: transparent;
            color: var(--color-text);
            flex: 1;
            font-size: 13px;
        }
        .provider-list {
            overflow-y: auto;
        }
        .provider-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
        }
        .provider-item:hover { background: var(--color-list-item-hover); }
        .provider-item.active { background: var(--color-primary-mute); }
        .provider-info { display: flex; align-items: center; gap: 10px; }
        .provider-avatar { width: 24px; height: 24px; border-radius: 6px; background: #2a2a2a; display:flex; align-items:center; justify-content:center; font-size:12px; }
        .provider-name { font-size: 14px; }
        .pill { padding: 0 8px; height: 20px; line-height: 20px; border-radius: 999px; background: #1f2a22; color:#5fe1a5; font-size: 12px; }

        .provider-detail-panel {
            background: var(--color-background-soft);
            border: 0.5px solid var(--color-border);
            border-radius: 8px;
            padding: 12px;
            height: calc(100vh - 160px);
            overflow: auto;
        }
        .kv-row { display:flex; align-items:center; gap:10px; margin: 8px 0 14px; }
        .kv-label { width: 90px; color: var(--color-text-secondary); font-size: 12px; }
        .kv-input { flex:1; padding: 8px 12px; border: 0.5px solid var(--color-border); border-radius:8px; background: var(--color-background); color: var(--color-text); }
        .kv-button { padding:6px 10px; border-radius:6px; border:0.5px solid var(--color-border); background: var(--color-background); color: var(--color-text); cursor:pointer; }
        .kv-button.primary { background: var(--color-primary); border-color: var(--color-primary); color: #fff; }

        .models-group { margin-top: 12px; }
        .models-title { font-weight:600; margin-bottom: 8px; }
        .model-card { background: var(--color-background); border: 0.5px solid var(--color-border); border-radius: 10px; padding: 10px 12px; display:flex; align-items:center; justify-content: space-between; margin-bottom:8px; }
        .model-left { display:flex; align-items:center; gap:10px; }
        .model-name { font-weight: 600; }
        .model-tags { display:flex; gap:6px; }
        .tag-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--color-primary); opacity:.8; }
        .model-actions { display:flex; gap:10px; color: var(--color-text-secondary); }

        .settings-section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .settings-section-description {
            font-size: 14px;
            color: var(--color-text-secondary);
            margin-bottom: 24px;
        }

        .settings-group {
            background-color: var(--color-background-soft);
            border: 0.5px solid var(--color-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .settings-group-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 16px;
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--color-border-mute);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item-label {
            flex: 1;
        }

        .settings-item-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--color-text);
            margin-bottom: 4px;
        }

        .settings-item-description {
            font-size: 12px;
            color: var(--color-text-secondary);
        }

        .settings-item-control {
            margin-left: 16px;
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        .settings-input {
            width: 200px;
            padding: 8px 12px;
            border: 0.5px solid var(--color-border);
            border-radius: 6px;
            background-color: var(--color-background);
            color: var(--color-text);
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .settings-input:focus {
            border-color: var(--color-primary);
        }

        .settings-input::placeholder {
            color: var(--color-text-secondary);
        }

        /* æŒ‰é’®æ ·å¼ */
        .settings-button {
            padding: 8px 16px;
            border: 0.5px solid var(--color-border);
            border-radius: 6px;
            background-color: var(--color-background-soft);
            color: var(--color-text);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .settings-button:hover {
            background-color: var(--color-hover);
        }

        .settings-button.primary {
            background-color: var(--color-primary);
            border-color: var(--color-primary);
            color: white;
        }

        .settings-button.primary:hover {
            background-color: var(--color-primary-soft);
        }

        /* å¼€å…³æ ·å¼ */
        .settings-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background-color: var(--color-border);
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .settings-switch.active {
            background-color: var(--color-primary);
        }

        .settings-switch-thumb {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.2s;
        }

        .settings-switch.active .settings-switch-thumb {
            transform: translateX(20px);
        }

        /* é€‰æ‹©æ¡†æ ·å¼ */
        .settings-select {
            width: 200px;
            padding: 8px 12px;
            border: 0.5px solid var(--color-border);
            border-radius: 6px;
            background-color: var(--color-background);
            color: var(--color-text);
            font-size: 14px;
            cursor: pointer;
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--color-border);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-border-soft);
        }

        /* éšè—ç±» */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div id="app" class="app-container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="top-navbar">
            <button class="navbar-back" onclick="goBack()">â†</button>
            <div class="navbar-center">è®¾ç½®</div>
        </div>

        <!-- è®¾ç½®å†…å®¹åŒºåŸŸ -->
        <div class="settings-container">
            <!-- è®¾ç½®ä¾§è¾¹æ  -->
            <div class="settings-sidebar">
                <button class="settings-menu-item active" data-section="provider">
                    <span class="settings-menu-item-icon">â˜ï¸</span>
                    æä¾›å•†
                </button>
                <button class="settings-menu-item" data-section="model">
                    <span class="settings-menu-item-icon">ğŸ“¦</span>
                    æ¨¡å‹
                </button>
                <div class="settings-menu-divider"></div>
                <button class="settings-menu-item" data-section="general">
                    <span class="settings-menu-item-icon">âš™ï¸</span>
                    å¸¸è§„
                </button>
                <button class="settings-menu-item" data-section="display">
                    <span class="settings-menu-item-icon">ğŸ–¥ï¸</span>
                    æ˜¾ç¤º
                </button>
                <button class="settings-menu-item" data-section="data">
                    <span class="settings-menu-item-icon">ğŸ’¾</span>
                    æ•°æ®
                </button>
                <div class="settings-menu-divider"></div>
                <button class="settings-menu-item" data-section="shortcut">
                    <span class="settings-menu-item-icon">âŒ¨ï¸</span>
                    å¿«æ·é”®
                </button>
                <button class="settings-menu-item" data-section="about">
                    <span class="settings-menu-item-icon">â„¹ï¸</span>
                    å…³äº
                </button>
            </div>

            <!-- è®¾ç½®å†…å®¹ -->
            <div class="settings-content">
                <!-- æä¾›å•†è®¾ç½® -->
                <div id="provider-section" class="settings-section">
                    <h1 class="settings-section-title">æ¨¡å‹æœåŠ¡</h1>
                    <p class="settings-section-description">ç®¡ç†æ¨¡å‹æä¾›å•†ã€APIå¯†é’¥ã€åŸºç¡€åœ°å€ä¸å¯ç”¨æ¨¡å‹</p>

                    <div class="provider-layout">
                        <div class="provider-list-panel">
                            <div class="provider-search">
                                <span>ğŸ”</span>
                                <input id="providerSearch" placeholder="æœç´¢æ¨¡å‹å¹³å°..." />
                            </div>
                            <div id="providerList" class="provider-list"></div>
                            <div style="margin-top:auto; padding-top:8px;">
                                <button id="addProviderBtn" class="kv-button" style="width:100%">ï¼‹ æ·»åŠ </button>
                            </div>
                        </div>

                        <div class="provider-detail-panel">
                            <div style="display:flex; align-items:center; gap:10px; margin-bottom:6px;">
                                <div id="detailAvatar" class="provider-avatar">AI</div>
                                <div id="detailTitle" style="font-weight:600;">-</div>
                                <span id="detailSwitch" class="pill" style="margin-left:auto; cursor:pointer;">OFF</span>
                            </div>
                            <div class="kv-row">
                                <div class="kv-label">API å¯†é’¥</div>
                                <input id="detailApiKey" type="password" class="kv-input" placeholder="****************" />
                                <button id="testKeyBtn" class="kv-button">æ£€æµ‹</button>
                            </div>
                            <div class="kv-row">
                                <div class="kv-label">API åœ°å€</div>
                                <input id="detailBaseUrl" class="kv-input" placeholder="https://api.openai.com" />
                            </div>

                            <div class="models-group">
                                <div class="models-title">æ¨¡å‹</div>
                                <div id="modelsContainer"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ¨¡å‹è®¾ç½® -->
                <div id="model-section" class="settings-section hidden">
                    <h1 class="settings-section-title">æ¨¡å‹è®¾ç½®</h1>
                    <p class="settings-section-description">é…ç½®é»˜è®¤æ¨¡å‹å’Œæ¨¡å‹å‚æ•°</p>

                    <div class="settings-group">
                        <h3 class="settings-group-title">é»˜è®¤æ¨¡å‹</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">é»˜è®¤æ¨¡å‹</div>
                                <div class="settings-item-description">å¯åŠ¨æ—¶ä½¿ç”¨çš„é»˜è®¤ AI æ¨¡å‹</div>
                            </div>
                            <div class="settings-item-control">
                                <select class="settings-select" id="defaultModel">
                                    <option value="gpt-4">GPT-4</option>
                                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                    <option value="claude-3">Claude 3</option>
                                    <option value="gemini-pro">Gemini Pro</option>
                                    <option value="local">æœ¬åœ°æ¨¡å‹</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3 class="settings-group-title">æ¨¡å‹å‚æ•°</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æ¸©åº¦</div>
                                <div class="settings-item-description">æ§åˆ¶å›å¤çš„éšæœºæ€§ (0-1)</div>
                            </div>
                            <div class="settings-item-control">
                                <input type="number" class="settings-input" id="temperature" min="0" max="1" step="0.1" value="0.7">
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æœ€å¤§ä»¤ç‰Œæ•°</div>
                                <div class="settings-item-description">å•æ¬¡å›å¤çš„æœ€å¤§ä»¤ç‰Œæ•°</div>
                            </div>
                            <div class="settings-item-control">
                                <input type="number" class="settings-input" id="maxTokens" min="1" max="4000" value="1000">
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">ç³»ç»Ÿæç¤ºè¯</div>
                                <div class="settings-item-description">æ¨¡å‹çš„ç³»ç»Ÿçº§æç¤ºè¯</div>
                            </div>
                            <div class="settings-item-control">
                                <textarea class="settings-input" id="systemPrompt" rows="3" placeholder="ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹ã€‚">ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹ã€‚</textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¸¸è§„è®¾ç½® -->
                <div id="general-section" class="settings-section hidden">
                    <h1 class="settings-section-title">å¸¸è§„è®¾ç½®</h1>
                    <p class="settings-section-description">åŸºæœ¬åº”ç”¨ç¨‹åºè®¾ç½®</p>

                    <div class="settings-group">
                        <h3 class="settings-group-title">ç•Œé¢</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">ä¸»é¢˜æ¨¡å¼</div>
                                <div class="settings-item-description">é€‰æ‹©åº”ç”¨ç¨‹åºçš„ä¸»é¢˜</div>
                            </div>
                            <div class="settings-item-control">
                                <select class="settings-select" id="themeMode">
                                    <option value="dark">æ·±è‰²</option>
                                    <option value="light">æµ…è‰²</option>
                                    <option value="auto">è‡ªåŠ¨</option>
                                </select>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">è¯­è¨€</div>
                                <div class="settings-item-description">åº”ç”¨ç¨‹åºç•Œé¢è¯­è¨€</div>
                            </div>
                            <div class="settings-item-control">
                                <select class="settings-select" id="language">
                                    <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                                    <option value="en-US">English</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ˜¾ç¤ºè®¾ç½® -->
                <div id="display-section" class="settings-section hidden">
                    <h1 class="settings-section-title">æ˜¾ç¤ºè®¾ç½®</h1>
                    <p class="settings-section-description">è‡ªå®šä¹‰ç•Œé¢æ˜¾ç¤ºé€‰é¡¹</p>

                    <div class="settings-group">
                        <h3 class="settings-group-title">èŠå¤©ç•Œé¢</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æ˜¾ç¤ºæ—¶é—´æˆ³</div>
                                <div class="settings-item-description">åœ¨æ¶ˆæ¯ä¸­æ˜¾ç¤ºæ—¶é—´æˆ³</div>
                            </div>
                            <div class="settings-item-control">
                                <div class="settings-switch active" id="showTimestamp"></div>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æ˜¾ç¤ºå¤´åƒ</div>
                                <div class="settings-item-description">åœ¨æ¶ˆæ¯ä¸­æ˜¾ç¤ºç”¨æˆ·å’ŒAIå¤´åƒ</div>
                            </div>
                            <div class="settings-item-control">
                                <div class="settings-switch active" id="showAvatar"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ•°æ®è®¾ç½® -->
                <div id="data-section" class="settings-section hidden">
                    <h1 class="settings-section-title">æ•°æ®è®¾ç½®</h1>
                    <p class="settings-section-description">ç®¡ç†åº”ç”¨ç¨‹åºæ•°æ®</p>

                    <div class="settings-group">
                        <h3 class="settings-group-title">æ•°æ®ç®¡ç†</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">å¯¼å‡ºé…ç½®</div>
                                <div class="settings-item-description">å¯¼å‡ºå½“å‰é…ç½®åˆ°æ–‡ä»¶</div>
                            </div>
                            <div class="settings-item-control">
                                <button class="settings-button" onclick="exportConfig()">å¯¼å‡º</button>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">å¯¼å…¥é…ç½®</div>
                                <div class="settings-item-description">ä»æ–‡ä»¶å¯¼å…¥é…ç½®</div>
                            </div>
                            <div class="settings-item-control">
                                <button class="settings-button" onclick="importConfig()">å¯¼å…¥</button>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">é‡ç½®é…ç½®</div>
                                <div class="settings-item-description">é‡ç½®æ‰€æœ‰è®¾ç½®ä¸ºé»˜è®¤å€¼</div>
                            </div>
                            <div class="settings-item-control">
                                <button class="settings-button" onclick="resetConfig()">é‡ç½®</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¿«æ·é”®è®¾ç½® -->
                <div id="shortcut-section" class="settings-section hidden">
                    <h1 class="settings-section-title">å¿«æ·é”®è®¾ç½®</h1>
                    <p class="settings-section-description">è‡ªå®šä¹‰é”®ç›˜å¿«æ·é”®</p>

                    <div class="settings-group">
                        <h3 class="settings-group-title">èŠå¤©å¿«æ·é”®</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">å‘é€æ¶ˆæ¯</div>
                                <div class="settings-item-description">å‘é€å½“å‰è¾“å…¥çš„æ¶ˆæ¯</div>
                            </div>
                            <div class="settings-item-control">
                                <kbd>Enter</kbd>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æ¢è¡Œ</div>
                                <div class="settings-item-description">åœ¨è¾“å…¥æ¡†ä¸­æ’å…¥æ¢è¡Œ</div>
                            </div>
                            <div class="settings-item-control">
                                <kbd>Shift + Enter</kbd>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æ‰“å¼€è®¾ç½®</div>
                                <div class="settings-item-description">æ‰“å¼€è®¾ç½®é¡µé¢</div>
                            </div>
                            <div class="settings-item-control">
                                <kbd>Ctrl + ,</kbd>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å…³äºè®¾ç½® -->
                <div id="about-section" class="settings-section hidden">
                    <h1 class="settings-section-title">å…³äº</h1>
                    <p class="settings-section-description">åº”ç”¨ç¨‹åºä¿¡æ¯</p>

                    <div class="settings-group">
                        <h3 class="settings-group-title">åº”ç”¨ç¨‹åºä¿¡æ¯</h3>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">åº”ç”¨ç¨‹åºåç§°</div>
                                <div class="settings-item-description">Cherry Studio for Houdini</div>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">ç‰ˆæœ¬</div>
                                <div class="settings-item-description">1.0.0</div>
                            </div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-label">
                                <div class="settings-item-title">æè¿°</div>
                                <div class="settings-item-description">é›†æˆåˆ° Houdini ä¸­çš„ AI èŠå¤©åŠ©æ‰‹ç•Œé¢</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€çŠ¶æ€
        let currentSection = 'provider';
        let config = {};

            // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            loadConfiguration();
            updateUI();
                // æ ¹æ®å“ˆå¸Œå®šä½åˆ°åˆ†ç»„ï¼Œä¾‹å¦‚ #provider / #model / #general ç­‰
                const hash = location.hash?.replace('#','');
                if (hash) {
                    const exists = document.querySelector(`[data-section="${hash}"]`);
                    if (exists) switchSection(hash);
                }
        });

        // äº‹ä»¶ç›‘å¬å™¨
        function initializeEventListeners() {
            // ä¾§è¾¹æ èœå•ç‚¹å‡»
            document.querySelectorAll('.settings-menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.dataset.section;
                    switchSection(section);
                });
            });

            // å¼€å…³ç‚¹å‡»
            document.querySelectorAll('.settings-switch').forEach(switchEl => {
                switchEl.addEventListener('click', function() {
                    this.classList.toggle('active');
                    saveConfiguration();
                });
            });

            // è¾“å…¥æ¡†å˜åŒ–
            document.querySelectorAll('.settings-input, .settings-select').forEach(input => {
                input.addEventListener('input', saveConfiguration);
                input.addEventListener('change', saveConfiguration);
            });

            // Provider æœç´¢
            const providerSearch = document.getElementById('providerSearch');
            if (providerSearch) {
                providerSearch.addEventListener('input', () => renderProviderList(providerSearch.value.trim()));
            }
            const addProviderBtn = document.getElementById('addProviderBtn');
            if (addProviderBtn) {
                addProviderBtn.addEventListener('click', () => addProvider());
            }
            const testKeyBtn = document.getElementById('testKeyBtn');
            if (testKeyBtn) {
                testKeyBtn.addEventListener('click', () => alert('æµ‹è¯•æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰'));
            }
        }

        // åˆ‡æ¢è®¾ç½®éƒ¨åˆ†
        function switchSection(section) {
            // æ›´æ–°ä¾§è¾¹æ é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.settings-menu-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${section}"]`).classList.add('active');

            // æ˜¾ç¤ºå¯¹åº”å†…å®¹
            document.querySelectorAll('.settings-section').forEach(sec => {
                sec.classList.add('hidden');
            });
            document.getElementById(`${section}-section`).classList.remove('hidden');

            currentSection = section;
        }

        // åŠ è½½é…ç½®
        function loadConfiguration() {
            const savedConfig = localStorage.getItem('cherryStudioConfig');
            if (savedConfig) {
                config = JSON.parse(savedConfig);
            } else {
                // é»˜è®¤é…ç½®
                config = {
                    openaiApiKey: '',
                    openaiBaseUrl: 'https://api.openai.com',
                    claudeApiKey: '',
                    geminiApiKey: '',
                    localLLMHost: 'http://localhost:11434',
                    localLLMModel: 'llama2',
                    defaultModel: 'gpt-4',
                    temperature: 0.7,
                    maxTokens: 1000,
                    systemPrompt: 'ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹ã€‚',
                    themeMode: 'dark',
                    language: 'zh-CN',
                    showTimestamp: true,
                    showAvatar: true
                };
            }

            // æ›´æ–°ç•Œé¢
            updateFormFields();

            // åˆå§‹åŒ– Provider åˆ—è¡¨
            if (!config.providers) {
                config.providers = [
                    { id: 'openai', name: 'OpenAI', on: true, apiKey: '', baseUrl: 'https://api.openai.com', models: ['gpt-4o','gpt-4','gpt-3.5-turbo'] },
                    { id: 'anthropic', name: 'Anthropic', on: false, apiKey: '', baseUrl: 'https://api.anthropic.com', models: ['claude-3','claude-2.1'] },
                    { id: 'google', name: 'Google', on: false, apiKey: '', baseUrl: 'https://generativelanguage.googleapis.com', models: ['gemini-pro'] },
                    { id: 'local', name: 'æœ¬åœ°æ¨¡å‹', on: false, apiKey: '', baseUrl: 'http://localhost:11434', models: ['llama2','qwen','phi'] },
                ];
                localStorage.setItem('cherryStudioConfig', JSON.stringify(config));
            }
            if (!config.selectedProviderId) config.selectedProviderId = config.providers[0]?.id;
            renderProviderList('');
            renderProviderDetail();
        }

        // æ›´æ–°è¡¨å•å­—æ®µ
        function updateFormFields() {
            Object.keys(config).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox' || element.classList.contains('settings-switch')) {
                        element.classList.toggle('active', config[key]);
                    } else {
                        element.value = config[key];
                    }
                }
            });
        }

        // ä¿å­˜é…ç½®
        function saveConfiguration() {
            // æ”¶é›†è¡¨å•æ•°æ®
            const formData = {
                openaiApiKey: document.getElementById('openaiApiKey').value,
                openaiBaseUrl: document.getElementById('openaiBaseUrl').value,
                claudeApiKey: document.getElementById('claudeApiKey').value,
                geminiApiKey: document.getElementById('geminiApiKey').value,
                localLLMHost: document.getElementById('localLLMHost').value,
                localLLMModel: document.getElementById('localLLMModel').value,
                defaultModel: document.getElementById('defaultModel').value,
                temperature: parseFloat(document.getElementById('temperature').value),
                maxTokens: parseInt(document.getElementById('maxTokens').value),
                systemPrompt: document.getElementById('systemPrompt').value,
                themeMode: document.getElementById('themeMode').value,
                language: document.getElementById('language').value,
                showTimestamp: document.getElementById('showTimestamp').classList.contains('active'),
                showAvatar: document.getElementById('showAvatar').classList.contains('active')
            };

            // ä¿å­˜åˆ° localStorage
            config = { ...config, ...formData };
            localStorage.setItem('cherryStudioConfig', JSON.stringify(config));
        }

        // æ›´æ–° UI
        function updateUI() {
            // è¿™é‡Œå¯ä»¥æ·»åŠ å…¶ä»– UI æ›´æ–°é€»è¾‘
        }

        // Provider ç®¡ç†
        function addProvider() {
            const newId = `custom-${Date.now()}`;
            config.providers.push({ id: newId, name: 'è‡ªå®šä¹‰', on: false, apiKey: '', baseUrl: '', models: [] });
            config.selectedProviderId = newId;
            saveConfiguration();
            renderProviderList(document.getElementById('providerSearch')?.value?.trim() || '');
            renderProviderDetail();
        }

        function renderProviderList(keyword) {
            const listEl = document.getElementById('providerList');
            if (!listEl) return;
            const providers = (config.providers || []).filter(p => !keyword || p.name.toLowerCase().includes(keyword.toLowerCase()));
            listEl.innerHTML = '';
            providers.forEach(p => {
                const item = document.createElement('div');
                item.className = 'provider-item' + (p.id === config.selectedProviderId ? ' active' : '');
                item.innerHTML = `
                    <div class="provider-info">
                        <div class="provider-avatar">${p.name.slice(0,1)}</div>
                        <div class="provider-name">${p.name}</div>
                    </div>
                    <span class="pill" style="${p.on ? '' : 'background:#362828;color:#f59f9f;'}">${p.on ? 'ON' : 'OFF'}</span>
                `;
                item.addEventListener('click', () => { config.selectedProviderId = p.id; renderProviderList(keyword); renderProviderDetail(); saveConfiguration(); });
                listEl.appendChild(item);
            });
        }

        function getSelectedProvider() { return (config.providers || []).find(p => p.id === config.selectedProviderId); }

        function renderProviderDetail() {
            const p = getSelectedProvider();
            const avatar = document.getElementById('detailAvatar');
            const title = document.getElementById('detailTitle');
            const sw = document.getElementById('detailSwitch');
            const keyInput = document.getElementById('detailApiKey');
            const baseUrlInput = document.getElementById('detailBaseUrl');
            const modelsContainer = document.getElementById('modelsContainer');
            if (!p) return;
            avatar.textContent = p.name.slice(0,1);
            title.textContent = p.name;
            sw.textContent = p.on ? 'ON' : 'OFF';
            sw.style.background = p.on ? '#1f2a22' : '#3a2626';
            sw.style.color = p.on ? '#5fe1a5' : '#f2b1b1';
            sw.onclick = () => { p.on = !p.on; saveConfiguration(); renderProviderList(document.getElementById('providerSearch')?.value?.trim() || ''); renderProviderDetail(); };
            keyInput.value = p.apiKey || '';
            keyInput.oninput = () => { p.apiKey = keyInput.value; saveConfiguration(); };
            baseUrlInput.value = p.baseUrl || '';
            baseUrlInput.oninput = () => { p.baseUrl = baseUrlInput.value; saveConfiguration(); };
            modelsContainer.innerHTML = '';
            (p.models || []).forEach(m => {
                const card = document.createElement('div');
                card.className = 'model-card';
                card.innerHTML = `
                    <div class="model-left">
                        <div class="provider-avatar">${m.split('-')[0].slice(0,1).toUpperCase()}</div>
                        <div>
                            <div class="model-name">${m}</div>
                            <div class="model-tags"><span class="tag-dot"></span><span class="tag-dot"></span><span class="tag-dot"></span></div>
                        </div>
                    </div>
                    <div class="model-actions">
                        <span title="è®¾ç½®">âš™ï¸</span>
                        <span title="åˆ é™¤" data-action="remove">ğŸ—‘ï¸</span>
                    </div>
                `;
                card.querySelector('[data-action="remove"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    p.models = p.models.filter(x => x !== m);
                    saveConfiguration();
                    renderProviderDetail();
                });
                modelsContainer.appendChild(card);
            });

            // æ·»åŠ æ¨¡å‹è¾“å…¥è¡Œ
            const addRow = document.createElement('div');
            addRow.className = 'kv-row';
            addRow.innerHTML = `
                <div class="kv-label">æ–°å¢æ¨¡å‹</div>
                <input id="addModelInput" class="kv-input" placeholder="å¦‚ gpt-4o æˆ– glm-4" />
                <button id="addModelBtn" class="kv-button primary">æ·»åŠ </button>
            `;
            modelsContainer.appendChild(addRow);
            document.getElementById('addModelBtn').onclick = () => {
                const v = document.getElementById('addModelInput').value.trim();
                if (!v) return;
                p.models = Array.from(new Set([...(p.models||[]), v]));
                saveConfiguration();
                renderProviderDetail();
            };
        }

        // è¿”å›ä¸Šä¸€é¡µ
        function goBack() {
            window.location.href = 'cherry-studio-clone.html';
        }

        // å¯¼å‡ºé…ç½®
        function exportConfig() {
            const dataStr = JSON.stringify(config, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cherry-studio-config.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        // å¯¼å…¥é…ç½®
        function importConfig() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedConfig = JSON.parse(e.target.result);
                            config = { ...config, ...importedConfig };
                            localStorage.setItem('cherryStudioConfig', JSON.stringify(config));
                            updateFormFields();
                            alert('é…ç½®å¯¼å…¥æˆåŠŸï¼');
                        } catch (error) {
                            alert('é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // é‡ç½®é…ç½®
        function resetConfig() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                localStorage.removeItem('cherryStudioConfig');
                loadConfiguration();
                alert('é…ç½®å·²é‡ç½®ï¼');
            }
        }

        // å¯¼å‡ºåˆ°å…¨å±€
        window.cherryStudioSettings = {
            loadConfiguration,
            saveConfiguration,
            config
        };
    </script>
</body>
</html>
