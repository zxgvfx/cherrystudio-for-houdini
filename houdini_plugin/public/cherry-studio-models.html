<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>模型管理 - Cherry Studio for Houdini</title>
    <style>
        :root {
            --color-white: #ffffff;
            --color-black: #181818;
            --color-background: var(--color-black);
            --color-background-soft: #222222;
            --color-background-mute: #333333;
            --color-text: rgba(255, 255, 245, 0.9);
            --color-text-secondary: rgba(235, 235, 245, 0.7);
            --color-border: #ffffff19;
            --color-border-soft: #ffffff10;
            --color-primary: #00b96b;
            --navbar-background: #1f1f1f;
        }
        html, body { height: 100%; margin: 0; background: var(--color-background); color: var(--color-text); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }
        .top-navbar { height: 48px; background: var(--navbar-background); border-bottom: 0.5px solid var(--color-border); display:flex; align-items:center; padding:0 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .navbar-back { width:32px; height:32px; display:flex; align-items:center; justify-content:center; border:none; background:transparent; color:var(--color-text-secondary); border-radius:6px; cursor:pointer; }
        .navbar-back:hover { background: var(--color-background-mute); }
        .navbar-center { flex:1; text-align:center; font-weight:600; }
        .page { padding: 20px; max-width: 960px; margin: 0 auto; }
        .card { background: var(--color-background-soft); border: 0.5px solid var(--color-border); border-radius: 8px; padding: 16px; margin-bottom: 16px; }
        .section-title { font-size: 16px; font-weight: 600; margin-bottom: 12px; }
        .row { display:flex; gap:12px; }
        .input { flex:1; min-width:0; padding:8px 12px; border: 0.5px solid var(--color-border); border-radius:6px; background: var(--color-background); color: var(--color-text); }
        .button { padding:8px 12px; border-radius:6px; border: 0.5px solid var(--color-border); background: var(--color-background-soft); color: var(--color-text); cursor:pointer; }
        .button.primary { background: var(--color-primary); border-color: var(--color-primary); color:#fff; }
        .button:hover { background: var(--color-background-mute); }
        .button.primary:hover { opacity: .9; }
        .table { width:100%; border-collapse: collapse; }
        .th, .td { text-align:left; padding:10px 12px; border-bottom: 0.5px solid var(--color-border-soft); }
        .th { color: var(--color-text-secondary); font-weight: 500; }
        .tag { padding:2px 8px; border-radius: 999px; background: #ffffff14; }
        .actions { display:flex; gap:8px; }
        .empty { color: var(--color-text-secondary); padding: 12px; }
    </style>
</head>
<body>
    <div class="top-navbar">
        <button class="navbar-back" onclick="goBack()">←</button>
        <div class="navbar-center">模型管理</div>
    </div>
    <div class="page">
        <div class="card">
            <div class="section-title">新增模型</div>
            <div class="row">
                <input id="modelId" class="input" placeholder="模型ID，例如 gpt-4o 或 llama3:8b" />
                <input id="provider" class="input" placeholder="提供商（openai / anthropic / google / local）" />
                <input id="label" class="input" placeholder="显示名称（可选）" />
                <button class="button primary" onclick="addModel()">添加</button>
            </div>
        </div>

        <div class="card">
            <div class="section-title">模型列表</div>
            <table class="table">
                <thead>
                    <tr>
                        <th class="th">模型ID</th>
                        <th class="th">提供商</th>
                        <th class="th">显示名称</th>
                        <th class="th">操作</th>
                    </tr>
                </thead>
                <tbody id="modelsBody"></tbody>
            </table>
            <div id="emptyTip" class="empty" style="display:none">暂无模型，请先添加。</div>
        </div>
    </div>

<script>
const STORAGE_KEY = 'cherryStudioModels';

function goBack(){ location.href = 'cherry-studio-clone.html'; }

function loadModels(){
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); } catch { return []; }
}
function saveModels(list){ localStorage.setItem(STORAGE_KEY, JSON.stringify(list)); }

function addModel(){
    const modelId = document.getElementById('modelId').value.trim();
    const provider = document.getElementById('provider').value.trim();
    const label = document.getElementById('label').value.trim();
    if(!modelId || !provider){ alert('请填写模型ID与提供商'); return; }
    const list = loadModels();
    if(list.some(m=>m.id===modelId)) { alert('该模型已存在'); return; }
    list.push({ id:modelId, provider, label: label||modelId });
    saveModels(list);
    render();
    document.getElementById('modelId').value = '';
    document.getElementById('provider').value = '';
    document.getElementById('label').value = '';
}

function removeModel(id){
    const list = loadModels().filter(m=>m.id!==id);
    saveModels(list);
    render();
}

function render(){
    const tbody = document.getElementById('modelsBody');
    const empty = document.getElementById('emptyTip');
    const list = loadModels();
    tbody.innerHTML='';
    if(list.length===0){ empty.style.display='block'; return; } else { empty.style.display='none'; }
    list.forEach(m=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td class="td"><span class="tag">${m.id}</span></td>
            <td class="td">${m.provider}</td>
            <td class="td">${m.label||m.id}</td>
            <td class="td">
                <div class="actions">
                    <button class="button" onclick="removeModel('${m.id.replace(/'/g, "&#39;")}')">删除</button>
                </div>
            </td>`;
        tbody.appendChild(tr);
    });
}

// 初始渲染
render();
</script>
</body>
</html>
