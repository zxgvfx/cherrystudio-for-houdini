<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cherry Studio æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .container {
            text-align: center;
            max-width: 800px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .status {
            font-size: 1.2em;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 255, 0, 0.2);
            border-radius: 10px;
            border: 2px solid rgba(0, 255, 0, 0.5);
        }
        .info {
            font-size: 1em;
            margin: 10px 0;
            opacity: 0.9;
        }
        .button {
            display: inline-block;
            padding: 15px 30px;
            margin: 10px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            text-decoration: none;
            font-size: 1.1em;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        .log {
            text-align: left;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’ Cherry Studio</h1>
        <div class="status">âœ… WebEngine åŠ è½½æˆåŠŸï¼</div>
        
        <div class="info">
            <p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æµ‹è¯•é¡µé¢ï¼Œç”¨äºéªŒè¯ Cherry Studio çš„ WebEngine é›†æˆæ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
            <p>å¦‚æœä½ èƒ½çœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œè¯´æ˜æ¨¡å—é‡æ„æˆåŠŸï¼</p>
        </div>
        
        <div class="button" onclick="testWebChannel()">æµ‹è¯• WebChannel</div>
        <div class="button" onclick="testAPIs()">æµ‹è¯• APIs</div>
        <div class="button" onclick="showLog()">æ˜¾ç¤ºæ—¥å¿—</div>
        
        <div id="log" class="log" style="display: none;">
            <div>=== Cherry Studio æµ‹è¯•æ—¥å¿— ===</div>
            <div id="log-content"></div>
        </div>
    </div>

    <script>
        let logContent = document.getElementById('log-content');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
        }
        
        function testWebChannel() {
            log('å¼€å§‹æµ‹è¯• WebChannel...');
            
            if (typeof qt !== 'undefined') {
                log('âœ… qt å¯¹è±¡å­˜åœ¨');
                
                if (qt.webChannelTransport) {
                    log('âœ… webChannelTransport å­˜åœ¨');
                } else {
                    log('âŒ webChannelTransport ä¸å­˜åœ¨');
                }
            } else {
                log('âŒ qt å¯¹è±¡ä¸å­˜åœ¨');
            }
            
            // æµ‹è¯• API å¯¹è±¡
            const apis = ['electron', 'api', 'file', 'selection', 'storeSync', 'network', 'houdini'];
            apis.forEach(apiName => {
                if (typeof qt !== 'undefined' && qt[apiName]) {
                    log(`âœ… ${apiName} API å¯ç”¨`);
                } else {
                    log(`âŒ ${apiName} API ä¸å¯ç”¨`);
                }
            });
        }
        
        function testAPIs() {
            log('å¼€å§‹æµ‹è¯• APIs...');
            
            if (typeof qt !== 'undefined') {
                // æµ‹è¯• electron API
                if (qt.electron) {
                    log('æµ‹è¯• electron API...');
                    try {
                        qt.electron.invoke('test').then(result => {
                            log(`electron.test() ç»“æœ: ${result}`);
                        }).catch(err => {
                            log(`electron.test() é”™è¯¯: ${err}`);
                        });
                    } catch (e) {
                        log(`electron API è°ƒç”¨å¤±è´¥: ${e.message}`);
                    }
                }
                
                // æµ‹è¯• file API
                if (qt.file) {
                    log('æµ‹è¯• file API...');
                    try {
                        qt.file.invoke('test').then(result => {
                            log(`file.test() ç»“æœ: ${result}`);
                        }).catch(err => {
                            log(`file.test() é”™è¯¯: ${err}`);
                        });
                    } catch (e) {
                        log(`file API è°ƒç”¨å¤±è´¥: ${e.message}`);
                    }
                }
            } else {
                log('âŒ qt å¯¹è±¡ä¸å­˜åœ¨ï¼Œæ— æ³•æµ‹è¯• APIs');
            }
        }
        
        function showLog() {
            const logDiv = document.getElementById('log');
            logDiv.style.display = logDiv.style.display === 'none' ? 'block' : 'none';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            log('é¡µé¢åŠ è½½å®Œæˆ');
            log('User Agent: ' + navigator.userAgent);
            log('å½“å‰æ—¶é—´: ' + new Date().toLocaleString());
            
            // è‡ªåŠ¨æµ‹è¯• WebChannel
            setTimeout(testWebChannel, 1000);
        });
        
        // ç›‘å¬ WebChannel æ¶ˆæ¯
        if (typeof qt !== 'undefined' && qt.webChannelTransport) {
            qt.webChannelTransport.onmessage = function(message) {
                log('æ”¶åˆ° WebChannel æ¶ˆæ¯: ' + JSON.stringify(message));
            };
        }
    </script>
</body>
</html>
